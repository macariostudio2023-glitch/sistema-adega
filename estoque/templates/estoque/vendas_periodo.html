{% extends "estoque/base.html" %}
{% block title %}Vendas por Per√≠odo - Sistema Adega{% endblock %}

{% block content %}
  <h2>üìÜ Vendas por Per√≠odo</h2>
  <p>Escolha as datas e veja o total vendido.</p>

  <form method="get">
    <label>Data in√≠cio</label>
    {{ form.data_inicio }}

    <label>Data fim</label>
    {{ form.data_fim }}

    <div class="actions">
      <button class="confirm" type="submit">Buscar</button>
    </div>
  </form>

  <hr style="border:0;border-top:1px solid rgba(255,255,255,.12);margin:18px 0;">

  {% if data_inicio and data_fim %}
    <p>Per√≠odo: <b>{{ data_inicio }}</b> at√© <b>{{ data_fim }}</b></p>

    {% if itens %}
      <div style="overflow-x:auto;">
        <table style="width:100%; border-collapse: collapse;">
          <thead>
            <tr>
              <th style="text-align:left; padding:10px; border-bottom:1px solid rgba(255,255,255,.12);">Data/Hora</th>
              <th style="text-align:left; padding:10px; border-bottom:1px solid rgba(255,255,255,.12);">Produto</th>
              <th style="text-align:right; padding:10px; border-bottom:1px solid rgba(255,255,255,.12);">Qtd</th>
              <th style="text-align:right; padding:10px; border-bottom:1px solid rgba(255,255,255,.12);">Pre√ßo venda</th>
            </tr>
          </thead>
          <tbody>
            {% for m in itens %}
              <tr>
                <td style="padding:10px; border-bottom:1px solid rgba(255,255,255,.08);">
                  {{ m.data|date:"d/m/Y H:i" }}
                </td>
                <td style="padding:10px; border-bottom:1px solid rgba(255,255,255,.08);">
                  {{ m.produto.nome }}
                </td>
                <td style="padding:10px; border-bottom:1px solid rgba(255,255,255,.08); text-align:right;">
                  {{ m.quantidade }}
                </td>
                <td style="padding:10px; border-bottom:1px solid rgba(255,255,255,.08); text-align:right;">
                  R$ {{ m.produto.preco_venda }}
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <h3 style="text-align:right; margin-top:16px;">
        Total do per√≠odo: <b>R$ {{ total }}</b>
      </h3>
    {% else %}
      <p>Nenhuma venda encontrada nesse per√≠odo.</p>
    {% endif %}
  {% else %}
    <div class="hint">Preencha as duas datas e clique em Buscar.</div>
  {% endif %}
{% endblock %}
